#pragma once

#ifndef __EMBED_PY_SRC

#include <stdio.h>

#include <format>
#include <optional>
#include <string>

static inline std::optional<std::string> get_py_src(const char *py_path) {
	std::string py_code;

	FILE *py_in = nullptr;
	if (fopen_s(&py_in, py_path, "rb") != 0) {
		puts(std::format("Python Source not found: {}", py_path).c_str());
		return {};
	}

	while (!feof(py_in)) {
		char buffer[513] = {0};
		fread(buffer, sizeof(char), 512, py_in);
		py_code += buffer;
	}

	fclose(py_in);
	return py_code;
}

#else

#define py_code R"(@__PY_SRC__@)"

#endif
